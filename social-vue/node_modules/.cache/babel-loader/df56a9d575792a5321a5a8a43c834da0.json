{"remainingRequest":"/home/ckg/A毕设/exam-vue/node_modules/babel-loader/lib/index.js!/home/ckg/A毕设/exam-vue/node_modules/cache-loader/dist/cjs.js??ref--1-0!/home/ckg/A毕设/exam-vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ckg/A毕设/exam-vue/src/components/chat/toolbar.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/ckg/A毕设/exam-vue/src/components/chat/toolbar.vue","mtime":1639584032000},{"path":"/home/ckg/A毕设/exam-vue/babel.config.js","mtime":1648737495000},{"path":"/home/ckg/A毕设/exam-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ckg/A毕设/exam-vue/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/ckg/A毕设/exam-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ckg/A毕设/exam-vue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcucmVwbGFjZS5qcyI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAidG9vbGJhciIsCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHVzZXI6IEpTT04ucGFyc2Uod2luZG93LnNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ3VzZXInKSksCiAgICAgIGZlZWRCYWNrRGlhbG9nVmlzaWJsZTogZmFsc2UsCiAgICAgIGZlZWRCYWNrQ29udGVudDogJycKICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICAvL+mAgOWHuuezu+e7nwogICAgZXhpdFN5c3RlbTogZnVuY3Rpb24gZXhpdFN5c3RlbSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHRoaXMuJGNvbmZpcm0oJ+S9oOaYr+WQpuimgemAgOWHuuezu+e7n+WQlz8nLCAn57O757uf5o+Q56S6JywgewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu5a6aJywKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywKICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMuZ2V0UmVxdWVzdCgiL2xvZ291dCIpOwoKICAgICAgICBzZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKCJ1c2VyIik7IC8v5riF6ZmkU2Vzc2lvblN0b3JhZ2XkuK3kv53lrZjnmoRzdGF0ZQoKICAgICAgICBpZiAoc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgic3RhdGUiKSkgewogICAgICAgICAgc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbSgic3RhdGUiKTsKICAgICAgICB9IC8v5YWz6Zet6L+e5o6lCgoKICAgICAgICBfdGhpcy4kc3RvcmUuZGlzcGF0Y2goImRpc2Nvbm5lY3QiKTsKCiAgICAgICAgX3RoaXMuJHJvdXRlci5yZXBsYWNlKCIvIik7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICB0eXBlOiAnaW5mbycsCiAgICAgICAgICBtZXNzYWdlOiAn5bey5Y+W5raI5pON5L2cJwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICAvL+mAieaLqeiBiuWkqeWIl+ihqAogICAgY2hvb3NlQ2hhdExpc3Q6IGZ1bmN0aW9uIGNob29zZUNoYXRMaXN0KGxpc3ROYW1lKSB7CiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgiY2hhbmdlQ3VycmVudExpc3QiLCBsaXN0TmFtZSk7CiAgICB9LAogICAgLy/miZPlvIDmhI/op4Hlj43ppojlr7nor53moYYKICAgIHNob3dGZWVkYmFja0RpYWxvZzogZnVuY3Rpb24gc2hvd0ZlZWRiYWNrRGlhbG9nKCkgewogICAgICB0aGlzLmZlZWRCYWNrQ29udGVudCA9ICcnOwogICAgICB0aGlzLmZlZWRCYWNrRGlhbG9nVmlzaWJsZSA9IHRydWU7CiAgICB9LAogICAgLy/lpITnkIblj43ppojmtojmga/pgq7ku7blj5HpgIEKICAgIGhhbmRsZUZlZWRiYWNrU2VuZDogZnVuY3Rpb24gaGFuZGxlRmVlZGJhY2tTZW5kKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciBtc2dPYmogPSB7fTsKICAgICAgbXNnT2JqLnVzZXJJZCA9IHRoaXMudXNlci5pZDsKICAgICAgbXNnT2JqLm5pY2tuYW1lID0gdGhpcy51c2VyLm5pY2tuYW1lOwogICAgICBtc2dPYmoudXNlcm5hbWUgPSB0aGlzLnVzZXIudXNlcm5hbWU7CiAgICAgIG1zZ09iai5jb250ZW50ID0gdGhpcy5mZWVkQmFja0NvbnRlbnQ7CiAgICAgIGNvbnNvbGUubG9nKG1zZ09iaik7CiAgICAgIHRoaXMucG9zdFJlcXVlc3QoIi9tYWlsL2ZlZWRiYWNrIiwgbXNnT2JqKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgICAgaWYgKHJlc3ApIHsKICAgICAgICAgIF90aGlzMi5mZWVkQmFja0RpYWxvZ1Zpc2libGUgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIC8v5riF56m66IGK5aSp6K6w5b2VCiAgICBjbGVhckNoYXRIaXN0b3J5OiBmdW5jdGlvbiBjbGVhckNoYXRIaXN0b3J5KCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHRoaXMuJGNvbmZpcm0oJ+atpOaTjeS9nOWwhuawuOS5heWIoOmZpOacrOWcsOiBiuWkqeiusOW9lSjnvqTogYrorrDlvZXkvJrlnKjkuIvmrKHnmbvlvZXml7bmgaLlpI0pLCDmmK/lkKbnu6fnu60/JywgJ+aPkOekuicsIHsKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsCiAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIC8v5riF6Zmk5pys5Zyw55qEbG9jYWxTdG9yYWdl5Lit55qE6IGK5aSp6K6w5b2VCiAgICAgICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJjaGF0LXNlc3Npb24iKSkgewogICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oImNoYXQtc2Vzc2lvbiIpOwogICAgICAgIH0gLy/muIXpmaRWdWV45Lit5L+d5a2Y55qE6K6w5b2VCgoKICAgICAgICBfdGhpczMuJHN0b3JlLnN0YXRlLnNlc3Npb25TdG9yYWdlID0ge307IC8v5riF6ZmkU2Vzc2lvblN0b3JhZ2XkuK3kv53lrZjnmoRzdGF0ZQoKICAgICAgICBpZiAoc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgic3RhdGUiKSkgewogICAgICAgICAgc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbSgic3RhdGUiKTsKICAgICAgICB9CgogICAgICAgIF90aGlzMy4kbWVzc2FnZSh7CiAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsCiAgICAgICAgICBtZXNzYWdlOiAn5Yig6Zmk5oiQ5YqfJwogICAgICAgIH0pOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMzLiRtZXNzYWdlKHsKICAgICAgICAgIHR5cGU6ICdpbmZvJywKICAgICAgICAgIG1lc3NhZ2U6ICflt7Llj5bmtojliKDpmaQnCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0KfTs="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2DA;AACAA,iBADA;AAEAC,MAFA,kBAEA;AACA;AACAC,6DADA;AAEAC,kCAFA;AAGAC;AAHA;AAKA,GARA;AASAC;AACA;AACAC,cAFA,wBAEA;AAAA;;AACA;AACAC,+BADA;AAEAC,8BAFA;AAGAC;AAHA,SAIAC,IAJA,CAIA;AACA;;AACAC,0CAFA,CAGA;;AACA;AACAA;AACA,SANA,CAOA;;;AACA;;AACA;AACA,OAdA,EAcAC,KAdA,CAcA;AACA;AACAH,sBADA;AAEAI;AAFA;AAIA,OAnBA;AAoBA,KAvBA;AAwBA;AACAC,kBAzBA,0BAyBAC,QAzBA,EAyBA;AACA;AACA,KA3BA;AA4BA;AACAC,sBA7BA,gCA6BA;AACA;AACA;AACA,KAhCA;AAiCA;AACAC,sBAlCA,gCAkCA;AAAA;;AACA;AACAC;AACAA;AACAA;AACAA;AACAC;AACA;AACA;AACA;AACA;AACA,OAJA;AAKA,KA9CA;AA+CA;AACAC,oBAhDA,8BAgDA;AAAA;;AACA;AACAb,+BADA;AAEAC,8BAFA;AAGAC;AAHA,SAIAC,IAJA,CAIA;AACA;AACA;AACAW;AACA,SAJA,CAKA;;;AACA,gDANA,CAOA;;AACA;AACAV;AACA;;AACA;AACAF,yBADA;AAEAI;AAFA;AAIA,OAnBA,EAmBAD,KAnBA,CAmBA;AACA;AACAH,sBADA;AAEAI;AAFA;AAIA,OAxBA;AAyBA;AA1EA;AATA","names":["name","data","user","feedBackDialogVisible","feedBackContent","methods","exitSystem","confirmButtonText","cancelButtonText","type","then","sessionStorage","catch","message","chooseChatList","listName","showFeedbackDialog","handleFeedbackSend","msgObj","console","clearChatHistory","localStorage"],"sourceRoot":"src/components/chat","sources":["toolbar.vue"],"sourcesContent":["<template>\n  <div id=\"toolbar\">\n    <el-image class=\"imgProfile\"\n              :src=\"user.userProfile\"\n              :preview-src-list=\"[user.userProfile]\"\n              :alt=\"user.nickname\">\n      <div slot=\"error\" class=\"image-slot\">\n        <i class=\"el-icon-picture-outline\"></i>\n      </div>\n    </el-image>\n    <div id=\"btnBar\">\n      <div class=\"topBtnBar\">\n        <el-tooltip  class=\"item\" effect=\"dark\" content=\"进入群聊\" placement=\"right\">\n        <el-button @click=\"chooseChatList('群聊')\" class=\"toolBtn\" size=\"small\"><i class=\"fa fa-comments fa-2x\" aria-hidden=\"true\"></i></el-button>\n        </el-tooltip>\n        <el-tooltip class=\"item\" effect=\"dark\" content=\"用户列表\" placement=\"right\">\n        <el-button @click=\"chooseChatList('私聊')\" class=\"toolBtn\" size=\"small\"><i class=\"fa fa-address-book-o fa-2x\" aria-hidden=\"true\"></i></el-button>\n        </el-tooltip>\n        <el-tooltip class=\"item\" effect=\"dark\" content=\"与机器人聊天\" placement=\"right\">\n          <el-button @click=\"chooseChatList('机器人')\" class=\"toolBtn\" size=\"small\"><i class=\"fa fa-android fa-2x\" aria-hidden=\"true\"></i></el-button>\n        </el-tooltip>\n      </div>\n      <div class=\"bottomBtnBar\">\n        <el-tooltip class=\"item\" effect=\"dark\" content=\"个人中心\" placement=\"right\">\n          <el-button class=\"toolBtn\" size=\"small\"><i class=\"fa fa-user fa-2x\" aria-hidden=\"true\"></i></el-button>\n        </el-tooltip>\n        <el-tooltip class=\"item\" effect=\"dark\" content=\"更多\" placement=\"right\">\n          <el-popover\n                  placement=\"right\"\n                  width=\"180\"\n                  trigger=\"click\"\n                  popper-class=\"moreListPopoverClass\"\n                   >\n            <ul id=\"moreList\">\n              <li @click=\"showFeedbackDialog\" >意见反馈</li>\n              <li>举报</li>\n              <li @click=\"clearChatHistory\">清空聊天记录</li>\n            </ul>\n            <el-button slot=\"reference\" class=\"toolBtn\" size=\"small\"><i class=\"fa fa-bars fa-2x\" aria-hidden=\"true\"></i></el-button>\n          </el-popover>\n        </el-tooltip>\n        <el-tooltip class=\"item\" effect=\"dark\" content=\"退出\" placement=\"right\">\n        <el-button @click=\"exitSystem\" class=\"toolBtn\" size=\"small\"><i class=\"fa fa-sign-out fa-2x\" aria-hidden=\"true\"></i></el-button>\n        </el-tooltip>\n      </div>\n    </div>\n    <el-dialog title=\"意见反馈\" :visible.sync=\"feedBackDialogVisible\" class=\"feedbackDialog\">\n      <textarea class=\"feedbackInput\" v-model=\"feedBackContent\">\n\n      </textarea>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button type=\"primary\" @click=\"handleFeedbackSend\">确 定</el-button>\n        <el-button @click=\"feedBackDialogVisible = false\">取 消</el-button>\n      </span>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\n  export default {\n    name: \"toolbar\",\n    data(){\n      return{\n        user:JSON.parse(window.sessionStorage.getItem('user')),\n        feedBackDialogVisible:false,\n        feedBackContent:'',\n      }\n    },\n    methods:{\n      //退出系统\n      exitSystem(){\n        this.$confirm('你是否要退出系统吗?', '系统提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(() => {\n          this.getRequest(\"/logout\");\n          sessionStorage.removeItem(\"user\");\n          //清除SessionStorage中保存的state\n          if (sessionStorage.getItem(\"state\")){\n            sessionStorage.removeItem(\"state\");\n          }\n          //关闭连接\n          this.$store.dispatch(\"disconnect\");\n          this.$router.replace(\"/\");\n        }).catch(() => {\n          this.$message({\n            type: 'info',\n            message: '已取消操作'\n          });\n        });\n      },\n      //选择聊天列表\n      chooseChatList(listName){\n        this.$store.commit(\"changeCurrentList\",listName);\n      },\n      //打开意见反馈对话框\n      showFeedbackDialog(){\n        this.feedBackContent='';\n        this.feedBackDialogVisible=true;\n      },\n      //处理反馈消息邮件发送\n      handleFeedbackSend(){\n        let msgObj={};\n        msgObj.userId=this.user.id;\n        msgObj.nickname=this.user.nickname;\n        msgObj.username=this.user.username;\n        msgObj.content=this.feedBackContent;\n        console.log(msgObj)\n        this.postRequest(\"/mail/feedback\",msgObj).then(resp=>{\n          if (resp) {\n            this.feedBackDialogVisible = false;\n          }\n        })\n      },\n      //清空聊天记录\n      clearChatHistory(){\n        this.$confirm('此操作将永久删除本地聊天记录(群聊记录会在下次登录时恢复), 是否继续?', '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(() => {\n          //清除本地的localStorage中的聊天记录\n          if (localStorage.getItem(\"chat-session\")){\n            localStorage.removeItem(\"chat-session\");\n          }\n          //清除Vuex中保存的记录\n          this.$store.state.sessionStorage={};\n          //清除SessionStorage中保存的state\n          if (sessionStorage.getItem(\"state\")){\n            sessionStorage.removeItem(\"state\");\n          }\n          this.$message({\n            type: 'success',\n            message: '删除成功'\n          });\n        }).catch(() => {\n          this.$message({\n            type: 'info',\n            message: '已取消删除'\n          });\n        });\n      }\n    }\n  }\n</script>\n\n<style lang=\"scss\" scoped>\n  #toolbar{\n    width: 100%;\n    height: 100%;\n    #btnBar{\n      width: 100%;\n      height: 82%;\n      display: flex;\n      flex-direction: column;\n      justify-content: space-between;\n    }\n    .imgProfile{\n      width: 40px;\n      height: 40px;\n      horiz-align: center;\n      margin: 25px 10px;\n    }\n    .toolBtn{\n      background-color: #2e3238;\n      border: 0;\n      margin: 5px 5px;\n    }\n    .feedbackDialog{\n      width: 1000px;\n      height: 800px;\n      margin: 10px auto;\n      //background-color: #ECEAE8;\n    }\n    .feedbackInput{\n      width: 450px;\n      height: 200px;\n      resize: none;\n      padding: 0;\n      margin: 0;\n    }\n  }\n\n\n  #moreList{\n    margin: 0px;\n    padding: 0px;\n    background-color: #2e3238;\n    li {\n      padding-top: 14px;\n      padding-bottom: 14px;\n      padding-left: 5px;\n      //padding-right: 40px;\n      //border-bottom: 1px solid #292C33;\n      list-style: none;\n      cursor: pointer;\n      &:hover {\n        background-color: #abaaaa;\n      }\n    }\n  }\n\n</style>\n<style lang=\"scss\">\n  /* el-popover是和app同级的，所以scoped的局部属性设置了无效 */\n  /* 需要设置全局style */\n  .el-popover.moreListPopoverClass{\n    height:150px;\n    width:150px;\n   // margin: 0px;\n    margin-left: 10px;\n    padding: 0px;\n    overflow-x: hidden;\n    overflow-y: hidden;\n    background-color:#2e3238;\n    border:none;\n  }\n</style>\n"]}]}