{"remainingRequest":"/home/ckg/A毕设/exam-vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ckg/A毕设/exam-vue/src/components/chat/toolbar.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/ckg/A毕设/exam-vue/src/components/chat/toolbar.vue","mtime":1639584032000},{"path":"/home/ckg/A毕设/exam-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ckg/A毕设/exam-vue/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/ckg/A毕设/exam-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ckg/A毕设/exam-vue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAidG9vbGJhciIsCiAgZGF0YSgpewogICAgcmV0dXJuewogICAgICB1c2VyOkpTT04ucGFyc2Uod2luZG93LnNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ3VzZXInKSksCiAgICAgIGZlZWRCYWNrRGlhbG9nVmlzaWJsZTpmYWxzZSwKICAgICAgZmVlZEJhY2tDb250ZW50OicnLAogICAgfQogIH0sCiAgbWV0aG9kczp7CiAgICAvL+mAgOWHuuezu+e7nwogICAgZXhpdFN5c3RlbSgpewogICAgICB0aGlzLiRjb25maXJtKCfkvaDmmK/lkKbopoHpgIDlh7rns7vnu5/lkJc/JywgJ+ezu+e7n+aPkOekuicsIHsKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsCiAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgIHRoaXMuZ2V0UmVxdWVzdCgiL2xvZ291dCIpOwogICAgICAgIHNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oInVzZXIiKTsKICAgICAgICAvL+a4hemZpFNlc3Npb25TdG9yYWdl5Lit5L+d5a2Y55qEc3RhdGUKICAgICAgICBpZiAoc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgic3RhdGUiKSl7CiAgICAgICAgICBzZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKCJzdGF0ZSIpOwogICAgICAgIH0KICAgICAgICAvL+WFs+mXrei/nuaOpQogICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJkaXNjb25uZWN0Iik7CiAgICAgICAgdGhpcy4kcm91dGVyLnJlcGxhY2UoIi8iKTsKICAgICAgfSkuY2F0Y2goKCkgPT4gewogICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgdHlwZTogJ2luZm8nLAogICAgICAgICAgbWVzc2FnZTogJ+W3suWPlua2iOaTjeS9nCcKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgLy/pgInmi6nogYrlpKnliJfooagKICAgIGNob29zZUNoYXRMaXN0KGxpc3ROYW1lKXsKICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCJjaGFuZ2VDdXJyZW50TGlzdCIsbGlzdE5hbWUpOwogICAgfSwKICAgIC8v5omT5byA5oSP6KeB5Y+N6aaI5a+56K+d5qGGCiAgICBzaG93RmVlZGJhY2tEaWFsb2coKXsKICAgICAgdGhpcy5mZWVkQmFja0NvbnRlbnQ9Jyc7CiAgICAgIHRoaXMuZmVlZEJhY2tEaWFsb2dWaXNpYmxlPXRydWU7CiAgICB9LAogICAgLy/lpITnkIblj43ppojmtojmga/pgq7ku7blj5HpgIEKICAgIGhhbmRsZUZlZWRiYWNrU2VuZCgpewogICAgICBsZXQgbXNnT2JqPXt9OwogICAgICBtc2dPYmoudXNlcklkPXRoaXMudXNlci5pZDsKICAgICAgbXNnT2JqLm5pY2tuYW1lPXRoaXMudXNlci5uaWNrbmFtZTsKICAgICAgbXNnT2JqLnVzZXJuYW1lPXRoaXMudXNlci51c2VybmFtZTsKICAgICAgbXNnT2JqLmNvbnRlbnQ9dGhpcy5mZWVkQmFja0NvbnRlbnQ7CiAgICAgIGNvbnNvbGUubG9nKG1zZ09iaikKICAgICAgdGhpcy5wb3N0UmVxdWVzdCgiL21haWwvZmVlZGJhY2siLG1zZ09iaikudGhlbihyZXNwPT57CiAgICAgICAgaWYgKHJlc3ApIHsKICAgICAgICAgIHRoaXMuZmVlZEJhY2tEaWFsb2dWaXNpYmxlID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIC8v5riF56m66IGK5aSp6K6w5b2VCiAgICBjbGVhckNoYXRIaXN0b3J5KCl7CiAgICAgIHRoaXMuJGNvbmZpcm0oJ+atpOaTjeS9nOWwhuawuOS5heWIoOmZpOacrOWcsOiBiuWkqeiusOW9lSjnvqTogYrorrDlvZXkvJrlnKjkuIvmrKHnmbvlvZXml7bmgaLlpI0pLCDmmK/lkKbnu6fnu60/JywgJ+aPkOekuicsIHsKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsCiAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgIC8v5riF6Zmk5pys5Zyw55qEbG9jYWxTdG9yYWdl5Lit55qE6IGK5aSp6K6w5b2VCiAgICAgICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJjaGF0LXNlc3Npb24iKSl7CiAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgiY2hhdC1zZXNzaW9uIik7CiAgICAgICAgfQogICAgICAgIC8v5riF6ZmkVnVleOS4reS/neWtmOeahOiusOW9lQogICAgICAgIHRoaXMuJHN0b3JlLnN0YXRlLnNlc3Npb25TdG9yYWdlPXt9OwogICAgICAgIC8v5riF6ZmkU2Vzc2lvblN0b3JhZ2XkuK3kv53lrZjnmoRzdGF0ZQogICAgICAgIGlmIChzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJzdGF0ZSIpKXsKICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oInN0YXRlIik7CiAgICAgICAgfQogICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgbWVzc2FnZTogJ+WIoOmZpOaIkOWKnycKICAgICAgICB9KTsKICAgICAgfSkuY2F0Y2goKCkgPT4gewogICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgdHlwZTogJ2luZm8nLAogICAgICAgICAgbWVzc2FnZTogJ+W3suWPlua2iOWIoOmZpCcKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["toolbar.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"toolbar.vue","sourceRoot":"src/components/chat","sourcesContent":["<template>\n  <div id=\"toolbar\">\n    <el-image class=\"imgProfile\"\n              :src=\"user.userProfile\"\n              :preview-src-list=\"[user.userProfile]\"\n              :alt=\"user.nickname\">\n      <div slot=\"error\" class=\"image-slot\">\n        <i class=\"el-icon-picture-outline\"></i>\n      </div>\n    </el-image>\n    <div id=\"btnBar\">\n      <div class=\"topBtnBar\">\n        <el-tooltip  class=\"item\" effect=\"dark\" content=\"进入群聊\" placement=\"right\">\n        <el-button @click=\"chooseChatList('群聊')\" class=\"toolBtn\" size=\"small\"><i class=\"fa fa-comments fa-2x\" aria-hidden=\"true\"></i></el-button>\n        </el-tooltip>\n        <el-tooltip class=\"item\" effect=\"dark\" content=\"用户列表\" placement=\"right\">\n        <el-button @click=\"chooseChatList('私聊')\" class=\"toolBtn\" size=\"small\"><i class=\"fa fa-address-book-o fa-2x\" aria-hidden=\"true\"></i></el-button>\n        </el-tooltip>\n        <el-tooltip class=\"item\" effect=\"dark\" content=\"与机器人聊天\" placement=\"right\">\n          <el-button @click=\"chooseChatList('机器人')\" class=\"toolBtn\" size=\"small\"><i class=\"fa fa-android fa-2x\" aria-hidden=\"true\"></i></el-button>\n        </el-tooltip>\n      </div>\n      <div class=\"bottomBtnBar\">\n        <el-tooltip class=\"item\" effect=\"dark\" content=\"个人中心\" placement=\"right\">\n          <el-button class=\"toolBtn\" size=\"small\"><i class=\"fa fa-user fa-2x\" aria-hidden=\"true\"></i></el-button>\n        </el-tooltip>\n        <el-tooltip class=\"item\" effect=\"dark\" content=\"更多\" placement=\"right\">\n          <el-popover\n                  placement=\"right\"\n                  width=\"180\"\n                  trigger=\"click\"\n                  popper-class=\"moreListPopoverClass\"\n                   >\n            <ul id=\"moreList\">\n              <li @click=\"showFeedbackDialog\" >意见反馈</li>\n              <li>举报</li>\n              <li @click=\"clearChatHistory\">清空聊天记录</li>\n            </ul>\n            <el-button slot=\"reference\" class=\"toolBtn\" size=\"small\"><i class=\"fa fa-bars fa-2x\" aria-hidden=\"true\"></i></el-button>\n          </el-popover>\n        </el-tooltip>\n        <el-tooltip class=\"item\" effect=\"dark\" content=\"退出\" placement=\"right\">\n        <el-button @click=\"exitSystem\" class=\"toolBtn\" size=\"small\"><i class=\"fa fa-sign-out fa-2x\" aria-hidden=\"true\"></i></el-button>\n        </el-tooltip>\n      </div>\n    </div>\n    <el-dialog title=\"意见反馈\" :visible.sync=\"feedBackDialogVisible\" class=\"feedbackDialog\">\n      <textarea class=\"feedbackInput\" v-model=\"feedBackContent\">\n\n      </textarea>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button type=\"primary\" @click=\"handleFeedbackSend\">确 定</el-button>\n        <el-button @click=\"feedBackDialogVisible = false\">取 消</el-button>\n      </span>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\n  export default {\n    name: \"toolbar\",\n    data(){\n      return{\n        user:JSON.parse(window.sessionStorage.getItem('user')),\n        feedBackDialogVisible:false,\n        feedBackContent:'',\n      }\n    },\n    methods:{\n      //退出系统\n      exitSystem(){\n        this.$confirm('你是否要退出系统吗?', '系统提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(() => {\n          this.getRequest(\"/logout\");\n          sessionStorage.removeItem(\"user\");\n          //清除SessionStorage中保存的state\n          if (sessionStorage.getItem(\"state\")){\n            sessionStorage.removeItem(\"state\");\n          }\n          //关闭连接\n          this.$store.dispatch(\"disconnect\");\n          this.$router.replace(\"/\");\n        }).catch(() => {\n          this.$message({\n            type: 'info',\n            message: '已取消操作'\n          });\n        });\n      },\n      //选择聊天列表\n      chooseChatList(listName){\n        this.$store.commit(\"changeCurrentList\",listName);\n      },\n      //打开意见反馈对话框\n      showFeedbackDialog(){\n        this.feedBackContent='';\n        this.feedBackDialogVisible=true;\n      },\n      //处理反馈消息邮件发送\n      handleFeedbackSend(){\n        let msgObj={};\n        msgObj.userId=this.user.id;\n        msgObj.nickname=this.user.nickname;\n        msgObj.username=this.user.username;\n        msgObj.content=this.feedBackContent;\n        console.log(msgObj)\n        this.postRequest(\"/mail/feedback\",msgObj).then(resp=>{\n          if (resp) {\n            this.feedBackDialogVisible = false;\n          }\n        })\n      },\n      //清空聊天记录\n      clearChatHistory(){\n        this.$confirm('此操作将永久删除本地聊天记录(群聊记录会在下次登录时恢复), 是否继续?', '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(() => {\n          //清除本地的localStorage中的聊天记录\n          if (localStorage.getItem(\"chat-session\")){\n            localStorage.removeItem(\"chat-session\");\n          }\n          //清除Vuex中保存的记录\n          this.$store.state.sessionStorage={};\n          //清除SessionStorage中保存的state\n          if (sessionStorage.getItem(\"state\")){\n            sessionStorage.removeItem(\"state\");\n          }\n          this.$message({\n            type: 'success',\n            message: '删除成功'\n          });\n        }).catch(() => {\n          this.$message({\n            type: 'info',\n            message: '已取消删除'\n          });\n        });\n      }\n    }\n  }\n</script>\n\n<style lang=\"scss\" scoped>\n  #toolbar{\n    width: 100%;\n    height: 100%;\n    #btnBar{\n      width: 100%;\n      height: 82%;\n      display: flex;\n      flex-direction: column;\n      justify-content: space-between;\n    }\n    .imgProfile{\n      width: 40px;\n      height: 40px;\n      horiz-align: center;\n      margin: 25px 10px;\n    }\n    .toolBtn{\n      background-color: #2e3238;\n      border: 0;\n      margin: 5px 5px;\n    }\n    .feedbackDialog{\n      width: 1000px;\n      height: 800px;\n      margin: 10px auto;\n      //background-color: #ECEAE8;\n    }\n    .feedbackInput{\n      width: 450px;\n      height: 200px;\n      resize: none;\n      padding: 0;\n      margin: 0;\n    }\n  }\n\n\n  #moreList{\n    margin: 0px;\n    padding: 0px;\n    background-color: #2e3238;\n    li {\n      padding-top: 14px;\n      padding-bottom: 14px;\n      padding-left: 5px;\n      //padding-right: 40px;\n      //border-bottom: 1px solid #292C33;\n      list-style: none;\n      cursor: pointer;\n      &:hover {\n        background-color: #abaaaa;\n      }\n    }\n  }\n\n</style>\n<style lang=\"scss\">\n  /* el-popover是和app同级的，所以scoped的局部属性设置了无效 */\n  /* 需要设置全局style */\n  .el-popover.moreListPopoverClass{\n    height:150px;\n    width:150px;\n   // margin: 0px;\n    margin-left: 10px;\n    padding: 0px;\n    overflow-x: hidden;\n    overflow-y: hidden;\n    background-color:#2e3238;\n    border:none;\n  }\n</style>\n"]}]}